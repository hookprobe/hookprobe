# HookProbe Guardian - dnsmasq Configuration
# Simple DHCP/DNS server for Guardian hotspot mode
# Version: 5.1.0
#
# Guardian Mode: Single network (192.168.4.0/27)
# For VLAN segmentation, use Fortress tier

# ============================================
# General Settings
# ============================================
domain-needed
bogus-priv
no-resolv
no-poll

# Local domain
domain=guardian.local
expand-hosts

# ============================================
# Upstream DNS Servers
# ============================================
# Privacy-focused DNS (can be changed via Web UI)
server=1.1.1.1
server=9.9.9.9
server=8.8.8.8

# ============================================
# Interface Configuration
# ============================================
# Listen only on the bridge interface (LAN side)
interface=br0
bind-dynamic

# Do NOT listen on WAN interfaces
except-interface=eth0
except-interface=wlan0
except-interface=lo

# ============================================
# DHCP Configuration - Guardian Network
# ============================================
# Network: 192.168.4.0/27 (30 usable addresses)
# Gateway: 192.168.4.1
# Range:   192.168.4.2 - 192.168.4.30

dhcp-range=192.168.4.2,192.168.4.30,255.255.255.224,24h
dhcp-option=option:router,192.168.4.1
dhcp-option=option:dns-server,192.168.4.1
dhcp-option=option:domain-search,guardian.local

# Set hostname for Guardian
dhcp-option=option:netbios-ns,192.168.4.1

# ============================================
# DHCP Lease Settings
# ============================================
# Lease file location
dhcp-leasefile=/var/lib/misc/dnsmasq.leases

# Send hostname to clients
dhcp-option=option:domain-name,guardian.local

# ============================================
# DNS Filtering Integration
# ============================================
# DNS Shield blocklist (if enabled)
# conf-file=/opt/hookprobe/guardian/dns-shield/blocklist.conf

# ============================================
# Logging
# ============================================
# Enable query logging for security monitoring
log-queries=extra
log-dhcp

# Log to file (rotated by logrotate)
log-facility=/var/log/hookprobe/dnsmasq.log

# ============================================
# Performance
# ============================================
# Cache size (larger for DNS filtering)
cache-size=10000
